(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{NUJY:function(t,e,n){"use strict";n.d(e,"c",function(){return i}),n.d(e,"d",function(){return s}),n.d(e,"b",function(){return o}),n.d(e,"a",function(){return c});var r=n("peOy"),a={user:"/user",role:"/role",service:"/service",permission:"/permission",permissionNoPager:"/permission/no-pager",orgTree:"/org/tree"};function i(t){return Object(r.b)({url:a.role,method:"get",params:t})}function s(t){return Object(r.b)({url:a.service,method:"get",params:t})}function o(t){return Object(r.b)({url:a.permissionNoPager,method:"get",params:t})}function c(t){return Object(r.b)({url:a.orgTree,method:"get",params:t})}},iLw5:function(t,e,n){(function(e){var n=1/0,r=9007199254740991,a="[object Arguments]",i="[object Function]",s="[object GeneratorFunction]",o="[object Symbol]",c="object"==typeof e&&e&&e.Object===Object&&e,l="object"==typeof self&&self&&self.Object===Object&&self,u=c||l||Function("return this")();function d(t,e){for(var n=-1,r=e.length,a=t.length;++n<r;)t[a+n]=e[n];return t}var f=Object.prototype,m=f.hasOwnProperty,p=f.toString,h=u.Symbol,v=f.propertyIsEnumerable,b=h?h.isConcatSpreadable:void 0,g=Math.max;function y(t){return j(t)||function(t){return function(t){return w(t)&&function(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=r}(t.length)&&!function(t){var e=function(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}(t)?p.call(t):"";return e==i||e==s}(t)}(t)}(t)&&m.call(t,"callee")&&(!v.call(t,"callee")||p.call(t)==a)}(t)||!!(b&&t&&t[b])}function _(t){if("string"==typeof t||function(t){return"symbol"==typeof t||w(t)&&p.call(t)==o}(t))return t;var e=t+"";return"0"==e&&1/t==-n?"-0":e}var j=Array.isArray;function w(t){return!!t&&"object"==typeof t}var O,k,x=(O=function(t,e){return null==t?{}:function(t,e){return function(t,e,n){for(var r=-1,a=e.length,i={};++r<a;){var s=e[r],o=t[s];n(o,s)&&(i[s]=o)}return i}(t=Object(t),e,function(e,n){return n in t})}(t,function(t,e){for(var n=-1,r=t?t.length:0,a=Array(r);++n<r;)a[n]=e(t[n],n,t);return a}(function t(e,n,r,a,i){var s=-1,o=e.length;for(r||(r=y),i||(i=[]);++s<o;){var c=e[s];n>0&&r(c)?n>1?t(c,n-1,r,a,i):d(i,c):a||(i[i.length]=c)}return i}(e,1),_))},k=g(void 0===k?O.length-1:k,0),function(){for(var t=arguments,e=-1,n=g(t.length-k,0),r=Array(n);++e<n;)r[e]=t[k+e];e=-1;for(var a=Array(k+1);++e<k;)a[e]=t[e];return a[k]=r,function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}(O,this,a)});t.exports=x}).call(this,n("yLpj"))},p7Uf:function(t,e,n){"use strict";n.r(e);n("rGqo");var r=n("q0+x"),a=n("NUJY"),i=n("wLw5"),s=n("iLw5"),o=n.n(s),c={name:"RoleModal",data:function(){return{labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},visible:!1,confirmLoading:!1,mdl:{},form:this.$form.createForm(this),permissions:[]}},created:function(){this.loadPermissions()},methods:{add:function(){this.edit({id:0})},edit:function(t){var e=this;if(this.mdl=Object.assign({},t),this.visible=!0,this.mdl.permissions&&this.permissions){var n={};this.mdl.permissions.forEach(function(t){n[t.permissionId]=t.actionEntitySet.map(function(t){return t.action})}),this.permissions.forEach(function(t){t.selected=n[t.id]||[]})}this.$nextTick(function(){e.form.setFieldsValue(o()(e.mdl,"id","name","status","describe"))}),console.log("this.mdl",this.mdl)},close:function(){this.$emit("close"),this.visible=!1},handleOk:function(){var t=this;this.form.validateFields(function(e,n){e||(console.log("form values",n),t.confirmLoading=!0,new Promise(function(t){setTimeout(function(){return t()},2e3)}).then(function(){t.$message.success("保存成功"),t.$emit("ok")}).catch(function(){}).finally(function(){t.confirmLoading=!1,t.close()}))})},handleCancel:function(){this.close()},onChangeCheck:function(t){t.indeterminate=!!t.selected.length&&t.selected.length<t.actionsOptions.length,t.checkedAll=t.selected.length===t.actionsOptions.length},onChangeCheckAll:function(t,e){Object.assign(e,{selected:t.target.checked?e.actionsOptions.map(function(t){return t.value}):[],indeterminate:!1,checkedAll:t.target.checked})},loadPermissions:function(){var t=this;Object(a.b)().then(function(e){var n=e.result;t.permissions=n.map(function(t){var e=Object(i.a)(t.actionData);return t.checkedAll=!1,t.selected=[],t.indeterminate=!1,t.actionsOptions=e.map(function(t){return{label:t.describe,value:t.action}}),t})})}}},l=n("KHd+"),u=Object(l.a)(c,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a-modal",{attrs:{title:"操作",width:800,visible:t.visible,confirmLoading:t.confirmLoading},on:{ok:t.handleOk,cancel:t.handleCancel}},[n("a-steps",{attrs:{current:1}},[n("a-step",[n("template",{slot:"title"},[t._v("\n        Finished\n      ")]),t._v(" "),n("span",{attrs:{slot:"description"},slot:"description"},[t._v("This is a description.")])],2),t._v(" "),n("a-step",{attrs:{title:"In Progress",description:"This is a description."}}),t._v(" "),n("a-step",{attrs:{title:"Waiting",description:"This is a description."}})],1)],1)},[],!1,null,"14838d1f",null).exports,d={name:"TableList",components:{STable:r.q,RoleModal:u},data:function(){var t=this;return{description:"列表使用场景：后台管理中的权限管理以及角色管理，可用于基于 RBAC 设计的角色权限控制，颗粒度细到每一个操作类型。",visible:!1,form:null,mdl:{},advanced:!1,queryParam:{},columns:[{title:"唯一识别码",dataIndex:"id"},{title:"角色名称",dataIndex:"name"},{title:"状态",dataIndex:"status"},{title:"创建时间",dataIndex:"createTime",sorter:!0},{title:"操作",width:"150px",dataIndex:"action",scopedSlots:{customRender:"action"}}],loadData:function(e){return t.$http.get("/role",{params:Object.assign(e,t.queryParam)}).then(function(t){return t.result})},selectedRowKeys:[],selectedRows:[]}},methods:{handleEdit:function(t){this.mdl=Object.assign({},t),this.mdl.permissions.forEach(function(t){t.actionsOptions=t.actionEntitySet.map(function(t){return{label:t.describe,value:t.action,defaultCheck:t.defaultCheck}})}),console.log(this.mdl),this.visible=!0},handleOk:function(){this.$refs.table.refresh()},onChange:function(t,e){this.selectedRowKeys=t,this.selectedRows=e},toggleAdvanced:function(){this.advanced=!this.advanced}},watch:{}},f=Object(l.a)(d,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a-card",{attrs:{bordered:!1}},[n("div",{staticClass:"table-page-search-wrapper"},[n("a-form",{attrs:{layout:"inline"}},[n("a-row",{attrs:{gutter:48}},[n("a-col",{attrs:{md:8,sm:24}},[n("a-form-item",{attrs:{label:"角色ID"}},[n("a-input",{attrs:{placeholder:"请输入"}})],1)],1),t._v(" "),n("a-col",{attrs:{md:8,sm:24}},[n("a-form-item",{attrs:{label:"状态"}},[n("a-select",{attrs:{placeholder:"请选择","default-value":"0"}},[n("a-select-option",{attrs:{value:"0"}},[t._v("全部")]),t._v(" "),n("a-select-option",{attrs:{value:"1"}},[t._v("正常")]),t._v(" "),n("a-select-option",{attrs:{value:"2"}},[t._v("禁用")])],1)],1)],1),t._v(" "),n("a-col",{attrs:{md:8,sm:24}},[n("span",{staticClass:"table-page-search-submitButtons"},[n("a-button",{attrs:{type:"primary"}},[t._v("查询")]),t._v(" "),n("a-button",{staticStyle:{"margin-left":"8px"}},[t._v("重置")])],1)])],1)],1)],1),t._v(" "),n("s-table",{ref:"table",attrs:{size:"default",columns:t.columns,data:t.loadData},scopedSlots:t._u([{key:"expandedRowRender",fn:function(e){return n("div",{staticStyle:{margin:"0"}},[n("a-row",{style:{marginBottom:"12px"},attrs:{gutter:24}},t._l(e.permissions,function(e,r){return n("a-col",{key:r,style:{marginBottom:"12px"},attrs:{span:12}},[n("a-col",{attrs:{span:4}},[n("span",[t._v(t._s(e.permissionName)+"：")])]),t._v(" "),e.actionEntitySet.length>0?n("a-col",{attrs:{span:20}},t._l(e.actionEntitySet,function(e,r){return n("a-tag",{key:r,attrs:{color:"cyan"}},[t._v(t._s(e.describe))])}),1):n("a-col",{attrs:{span:20}},[t._v("-")])],1)}),1)],1)}},{key:"action",fn:function(e,r){return n("span",{},[n("a",{on:{click:function(e){return t.$refs.modal.edit(r)}}},[t._v("编辑")]),t._v(" "),n("a-divider",{attrs:{type:"vertical"}}),t._v(" "),n("a-dropdown",[n("a",{staticClass:"ant-dropdown-link"},[t._v("\n          更多 "),n("a-icon",{attrs:{type:"down"}})],1),t._v(" "),n("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[n("a-menu-item",[n("a",{attrs:{href:"javascript:;"}},[t._v("详情")])]),t._v(" "),n("a-menu-item",[n("a",{attrs:{href:"javascript:;"}},[t._v("禁用")])]),t._v(" "),n("a-menu-item",[n("a",{attrs:{href:"javascript:;"}},[t._v("删除")])])],1)],1)],1)}}])}),t._v(" "),n("role-modal",{ref:"modal",on:{ok:t.handleOk}})],1)},[],!1,null,null,null);e.default=f.exports},wLw5:function(t,e,n){"use strict";function r(t){try{return JSON.parse(t)}catch(t){console.log("err",t.message)}return[]}n.d(e,"a",function(){return r})}}]);